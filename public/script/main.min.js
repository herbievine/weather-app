function getLocation(){if(!navigator.geolocation)return displayError(null,"Geolocation is not supported by your browser!",!0);navigator.geolocation.getCurrentPosition(getData)}async function getData(e){const t=`darksky-weather/:${e.coords.latitude},${e.coords.longitude}`,o=await fetch(t),n=await o.json();return n.code?(displayError(n.code,n.error,!1),console.log(`API Error ${n.code} (${n.error})`)):n.code?void 0:displayData(n)}async function getInput(){const e=document.getElementById("input").value;document.getElementById("input").value="";const t=/script|img|>|<|=/gi;if(t.test(e)||t.test(e))return displayError(null,"XSS Injection Detected",!0);if(!e)return displayError(null,"Please enter a city name",!0);{let t,o,n,r;const i=`/open-weather/${e}`,a=await fetch(i),c=await a.json();if(c.cod&&"2"!=c.cod.toString().split("")[0])return n=!0,displayError(c.cod,c.message.split(".")[0],!1),console.log(`API Error ${c.cod} (${c.message})`);if(c.code||(t=c.coord.lon,o=c.coord.lat),!n){const e=`darksky-weather/:${o},${t}`,n=await fetch(e),i=await n.json();if(i.code)return displayError(i.code,i.error,!1),console.log(`API Error ${i.code} (${i.error})`);if(!i.code)return r=!0,displayData(i),initMap(null,r,i)}}}function displayData(e){let t=e.timezone.split("/")[1];t.includes("_")&&(t=t.replace(/_/g," ")),document.getElementById("location").innerHTML=t,document.getElementById("current").innerHTML=`<strong><u>Currently:</u></strong><br>Temperature: ${e.currently.temperature}Â°C<br>Wind Speed: ${e.currently.windSpeed} metres/sec`,document.getElementById("hourly").innerHTML=`<strong><u>Today:</u></strong><br>Summary: ${e.hourly.summary}`,document.getElementById("days").innerHTML=`<strong><u>Next few days:</u></strong><br>Summary: ${e.daily.summary}`,showIcon(e)}function displayError(e,t,o){e&&!o&&5===e.split("")[0]&&(o=!0,t="Sorry, something went wrong..."),o?o&&(document.getElementById("error-container").style.height="30px",document.getElementById("error-container").style.transition="height 0.3s ease-in",document.getElementById("error-msg").innerHTML=t):(document.getElementById("error-container").style.height="30px",document.getElementById("error-container").style.transition="height 0.3s ease-in",document.getElementById("error-msg").innerHTML=`Error: ${e} - ${t}`),setTimeout(()=>{document.getElementById("error-container").style.height="0px",document.getElementById("error-container").style.transition="height 0.3s ease-out",document.getElementById("error-msg").innerHTML=""},5e3)}function showIcon(e){const t=new Skycons({color:"white"});t.add(document.getElementById("current-icon"),e.currently.icon),t.add(document.getElementById("hourly-icon"),e.hourly.icon),t.add(document.getElementById("days-icon"),e.daily.icon),t.play()}function mapCoords(){if(!navigator.geolocation)return displayError(null,"Geolocation is not supported by your browser!",!0);navigator.geolocation.getCurrentPosition(initMap)}function initMap(e,t,o){if(t){const e={lat:o.latitude,lng:o.longitude},t=new google.maps.Map(document.getElementById("map"),{zoom:10,center:e});new google.maps.Marker({position:e,map:t})}else if(!t){const t={lat:e.coords.latitude,lng:e.coords.longitude},o=new google.maps.Map(document.getElementById("map"),{zoom:10,center:t});new google.maps.Marker({position:t,map:o})}}